Achieve feature parity with original:
* Implement restricted galleries.

* Refactor.
* Unittest.
